<?php$class_names = [		'content'];$pageTitle = " Content - Create & Update differnt contents ";?><?php include_once("../../includes/functions/loader.inc"); ?><?php  if(!empty($_POST)){ return;}?><?phpif (!empty($_GET['category_id'])) { $category_id = $_GET['category_id'];}if (!empty($_GET['content_type'])) { $content_type_name = $_GET['content_type'];} elseif (!empty($_GET['content_type_id'])) { $content_type_id = $_GET['content_type_id'];} else { $content_type_name = 'content';}if (!empty($_GET['parent_id'])) { $parent_id = $_GET['parent_id'];}?><script type='text/javascript' src="content.js" ></script><link href="content.css" media="all" rel="stylesheet" type="text/css" /><?php$class = $class_first = 'content';$$class = $$class_first = &$content;$class_second = 'extra_content';$$class_second = &$extra_content;?><?phpif (empty($content->parent_id) && !(empty($parent_id))) { $content->parent_id = $parent_id;}if (!empty($content_type_id)) { $content_type = content_type::find_by_id($content_type_id); $content_type_name = $content_type->content_type;} elseif (!empty($content_type_name)) { $content_type = content_type::find_by_content_type($content_type_name);}content::$content_table_name = 'c_' . $content_type_name;//$extra_fields = new_content_type::find_fields_by_id($content_type->content_type_id);$$class->content_type_id = $content_type->content_type_id;//echo '<br> $$extension->content_type_id is '. $content_type->content_type_id ;$content_field_array = content::$content_field_array;foreach ($extra_fields as $records) { $content_field_array[] = $records->field_name;}//save contend id in a variable. get value for extra content save after content save$contentId = $content->content_id;foreach ($content_field_array as $key => $value) { if (!empty($_POST[$value][0])) {	$$class->$value = trim(mysql_prep($_POST[$value][0])); } else {	$$class->$value = ""; }}$content->content_id = $contentId;//get the extra content value of existing conetnt - used for update.if (!empty($content->content_id)) { $extra_content = content::content_find_by_id($content_type_name, $content->content_id);}function cmp($a, $b) { return $a->field_position - $b->field_position;}if(!empty($extra_fields)){usort($extra_fields, "cmp");}//echo 'extra fields<pre>';//print_r($extra_fields);//// echo '<br> extra content<pre>';// print_r($extra_content); //form element to show on form$form_element = "";foreach ($extra_fields as $records) { $field_label = !empty($records->field_label) ? $records->field_label : $records->field_name; $requiredClass = !empty($records->required_cb) ? ' required ' : ''; $field_type = $records->field_type; $field = $records->field_name; $type_array = explode("(", $records->Type); if (!empty($type_array[1])) {	$field_num = rtrim($type_array[1], ")"); } if (!empty($extra_content->$field)) {	$value = htmlentities($extra_content->$field); } else {	$value = ""; } if ($field != 'content_id') {	switch ($field_type) {	 case 'int' :		$form_element .= '<div class="'. $requiredClass. ' new_element int"><label>' . $field_label . ' : </label>        <input type="number" name="' . $field . '[]" class="' . $field . '"         value="' . $value . '">       </div>';		break;	 case 'varchar' :		if (!empty($records->option_type)) {		 $form_element .= '<div class="'. $requiredClass. 'new_element option"><label>' . $field_label . ' : </label>';		 $form_element .= form::select_field_from_object($field, option_line::find_by_option_id($records->option_type), 'option_line_code', 'option_line_value', $value, '', '', 'option', '', '');		 $form_element .= '</div>';		}else{		$form_element .= '<div class="'. $requiredClass. 'new_element varchar"><label>' . $field_label . ' : </label>        <input type="text" name="' . $field . '[]" class="' . $field . '"         value="' . $value . '">       </div>';		}		break;	 case 'text' :		$form_element .= '<div class="'. $requiredClass. 'new_element text"><label>' . $field_label . ' : </label>        <textarea name="' . $field . '[]" class="bigtext ' . $field . '">' . $value . '</textarea>       </div>';		break;	 case 'mediumtext' :		$form_element .= '<div class="'. $requiredClass. 'new_element mediumtext"><label>' . $field_label . ' : </label>        <textarea name="' . $field . '[]" class="noformat ' . $field . '">' . $value . '</textarea>       </div>';		break;	 case 'date' :		$form_element .= '<div class="'. $requiredClass. 'new_element varchar"><label>' . $field_label . ' : </label>        <input type="date" name="' . $field . '[]" class="' . $field . '"         value="' . $value . '">       </div>';		break;	 case 'tinyint' :		$form_element .= '<div class="'. $requiredClass. 'new_element tinyint"><label>' . $field_label . ' : </label>        <input type="checkbox" name="' . $field . '[]" class="checkbox' . $field . '"         value="' . $value . '">       </div>';		break;	 case 'enum' :		$form_element .= '<div class="'. $requiredClass. 'new_element enum"><label>' . $field_label . ' : </label>        <select name="' . $field . '[]" class="checkbox" ' . $field . '>';		$form_element .='<option value=" "></option>';		$value_list = explode(",", $field_num);//            echo '<pre>';//            print_r($value_list);//            echo '<pre>';		foreach ($value_list as $key => $option_value) {		 $option_value = trim($option_value, "'");		 if ($option_value == $value) {			$selected = ' selected ';		 } else {			$selected = ' ';		 }//             echo $option_value;		 $form_element .= "<option value=\"$option_value\"  $selected > $option_value </option>";		}		$form_element .= '</select></div>';		break;	 default :		$form_element .= '<div class="new_element varchar"><label>' . $field . ' : </label>        <input type="text" name="' . $field . '[] " class="' . $field . '"         value="' . $value . '">       </div>';	} }}//category for new content$major_category_of_content_type = category::find_by_reference_table_and_id('content_type', $content_type->content_type_id);if (!empty($major_category_of_content_type)) { $categories_of_content_type_select_option_array = array(); foreach ($major_category_of_content_type as $objects) {	$primary_category = $objects->category;	$categories_of_content_type_select_option = category::all_child_category_select_options($primary_category);	$categories_of_content_type_select_option_array[] = $categories_of_content_type_select_option; }}//start of categories/* if $category is missing from main function bur $category_id present in GET then insert $category_id to * $category array */if((empty($category)) && !empty($category_id)){ $category_obj = category::find_by_id($category_id); $category = []; array_push($category, $category_obj);}if ((!empty($category)) && (!empty($major_category_of_content_type))) { $category_select_statement_array = array(); foreach ($category as $content_category) {	$category_select_statement = "";	$category_id = $content_category->category_id;	$major_category_id = category::find_major_category_id($category_id);	$major_category_obj = category::find_by_id($major_category_id);	$major_category = $major_category_obj->category;	$all_child_categories = category::all_child_categories($major_category);//  echo '<br/>$major_category_id is'. $major_category_id. $major_category; //  echo '<pre>';// print_r($all_child_categories);// echo '<pre>';	foreach ($all_child_categories as $object) {	 if ($category_id == $object['category_id']) {		$selected = " selected ";		$found = 1;	 } else {		$selected = "";		$found = 0;	 } $category_select_statement .= '<option class="one_tab" value="' . $object['category_id'] . '"' .					 $selected . '>' . $object['category'] . '</option>';	 if (!empty($object['child'])) {		foreach ($object['child'] as $child1) {		 if ($category_id == $child1 ['category_id']) {			$selected1 = " selected ";		 } else {			$selected1 = "";		 }		 $category_select_statement .= '<option class="two_tab" value="' . $child1['category_id'] . '"' .						 $selected1 . '>-' . $child1['category'] . '</option>';		 if (!empty($child1['child'])) {			foreach ($child1['child'] as $child2) {			 if ($category_id == $child2 ['category_id']) {				$selected2 = " selected ";			 } else {				$selected2 = "";			 }			 $category_select_statement .= '<option class="three_tab" value="' . $child2['category_id'] . '"' .							 $selected2 . '>--' . $child2['category'] . '</option>';			 if (!empty($child2['child'])) {				foreach ($child2['child'] as $child3) {				 if ($category_id == $child3 ['category_id']) {					$selected3 = " selected ";				 } else {					$selected3 = "";				 }				 $category_select_statement .= '<option class="four_tab" value="' . $child3['category_id'] . '"' .								 $selected3 . '>---' . $child3['category'] . '</option>';				}			 }			}		 }		}	 }	}	$category_select_statement_array[] = $category_select_statement;//  echo $category_select_statement;	unset($category_select_statement); }} $breadCrum = "";if ((!empty($category))&& (!empty($content_type_name))) { foreach ($category as $object) {	$breadCrum .= category::breadCrum_by_category_contentType($object->category_id, $content_type_name);	$breadCrum .='<a class="new_post " href="'.HOME_URL.'extensions/content/content.php?content_type='.$content_type_name.					'&category_id='.$object->category_id.'"> >>> New Post..</a>';  }}elseif((!empty($category_id))&& (!empty($content_type_name))){ $breadCrum .= category::breadCrum_by_category_contentType($category_id, $content_type_name);	$breadCrum .='<a class="new_post " href="'.HOME_URL.'extensions/content/content.php?content_type='.$content_type_name.					'&category_id='.$category_id.'"> >>> New Post..</a>'; }if (!empty($msg)) { $show_message = '<div id="dialog_box">'; foreach ($msg as $key => $value) {	$x = $key + 1;	$show_message .= 'Message ' . $x . ' : ' . $value . '<br />'; } $show_message .= '</div>';}?>